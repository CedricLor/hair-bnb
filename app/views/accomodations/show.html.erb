<div class="fluid-container">
  <div class="row">
    <div class="col-xs-12">
      <% @accomodation.photos.each do |photo| %>
      <%= image_tag photo.picture.url(:medium), class: "img-thumbnail", height: "300" %>
      <% end %>
    </div>
  </div>
</div>
<div class="container">
  <!-- TO DO: Remove <br><br> and replace with smart CSS -->
  <br><br>
  <div class="row">
    <div class="col-xs-12 col-sm-4">
      <div class="row">
        <div class="col-xs-11">
          <div class="card-block shadowed-box">
            <!-- TO DO David: Update profile picture of the owner -->
            <%= image_tag("beard1.jpg", class: "img-circle", height: "50") %>
            <!-- TO DO: Align properly with smart CSS -->
            <p><%= "#{@owner.first_name} #{@owner.last_name}" %></p>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-xs-11">
          <div class="card-block shadowed-box">
            <h1><%= @accomodation.description %></h1>
            <p><%= "#{@accomodation.locality}, #{@accomodation.country}" %><p>
            <p>Ratings: <i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star-o"></i>(19)</p>
            <p>Rate per night: € <%= @accomodation.night_rate %></p>
            <ul class="list-unstyled list-inline">
              <li>
                <i class="fa fa-home"></i>
                Entire home/apt
              </li>
              <li>
                <i class="fa fa-user"></i>
                <span><%= @accomodation.accomodates %></span> Guests
              </li>
              <li>
                <i class="fa fa-building"></i>
                1 Bedroom
              </li>
              <li>
                <i class="fa fa-bed"></i>
                1 Bed
              </li>
            </ul>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-xs-11">
          <div class="card-block shadowed-box">
            <h3>About The Owner</h3>
            <p class="text-center">
              <%= image_tag("beard1.jpg", class: "img-circle", height: "50") %>
              <br>John Doe
            </p>
            <p class="text-center">Ratings: <i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star"></i><i class="fa fa-star-o"></i>(1908)</p>
            <p class="text-center">
              <%= mail_to "me@domain.com", "Email-me", class: "btn btn-default" %>
            </p>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xs-12 col-sm-5"><!-- Availabilities -->
      <div class="row">
        <div class="col-xs-11">
          <div class="card-block shadowed-box">
            <h3 class="text-center">Booked Dates</h3>
            <% @accomodation_bookings.each do |booking| %>
              <div class="row">
                <div class="col-xs-8">
                  <%= "From #{booking.from.strftime("%F")} to #{booking.to.strftime("%F")} " %>
                </div>
                <div class="col-xs-4">
                  <% if booking.accepted == false %>
                    <%= "Pending" %>
                  <% else %>
                    <%= "Confirmed" %>
                  <% end %>
                </div>
              </div>
            <% end %>
          </div>
        </div>
      </div>
    </div>
    <div class="col-xs-12 col-sm-3"><!-- Bookings -->
      <div class="card-block shadowed-box">
        <h3 class="text-center">Book</h3>
        <% if params[:user_id].present? %>
          <%= simple_form_for [@user, @accomodation, @booking] do |f| %>
            <%= f.input :from, as: :date, start_year: Date.today.year,
                                  end_year: Date.today.year, discard_day: false,
                                  order: [:day, :month, :year] %>
            <%= f.input :to, as: :date, start_year: Date.today.year + 1,
                                  end_year: Date.today.year, discard_day: false,
                                  order: [:day, :month, :year] %>
            <%= f.button :submit %>
          <% end %>
        <% else %>
          <%= simple_form_for [@accomodation, @booking] do |f| %>
            <%= f.input :from, as: :date, start_year: Date.today.year,
                                  end_year: Date.today.year, discard_day: false,
                                  order: [:day, :month, :year] %>
            <%= f.input :to, as: :date, start_year: Date.today.year + 1,
                                  end_year: Date.today.year, discard_day: false,
                                  order: [:day, :month, :year] %>
            <%= f.button :submit %>
          <% end %>
        <% end %>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-12 col-sm-12">
      <div class="card-block shadowed-box">
        <h3>About This Listing</h3>
        <p>With Hair'Bnb, you can find hairy accommodations at hairy people's places. The listing details below explain what you'll find in this space. If you have any questions, you can contact the host directly.</p>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-xs-12 col-sm-12">
      <div class="card-block shadowed-box">
        <div class="row">
          <div class="col-xs-12 col-md-2">
            The Space
          </div>
          <div class="col-xs-12 col-md-4">
            <div class="row">
              <div class="col-xs-12">
                Bed type: Pull-out Sofa
              </div>
              <div class="col-xs-12">
                Bedrooms: 1
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-12 col-md-2">
            Amenities
          </div>
          <div class="col-xs-12 col-md-4">
            <div class="row">
              <div class="col-xs-12">
                Kitchen
              </div>
              <div class="col-xs-12">
                Free Parking
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-12 col-md-2">
            Prices
          </div>
          <div class="col-xs-12 col-md-4">
            <div class="row">
              <div class="col-xs-12">
                Extra people: No Charge
              </div>
              <div class="col-xs-12">
                Cancellation: Moderate
              </div>
            </div>
          </div>
        </div>
        <div class="row">
          <div class="col-xs-12 col-md-2">
            Description
          </div>
          <div class="col-xs-12 col-md-8">
            Studio de 20m² refait à neuf.
            Il donne coté cour. Il se situe à 15 min de République à pied, 200m du métro ainsi que d'une station V'lille.
            Nous serons ravis de vous accueillir chez nous. Comptez sur nous pour vous donner quelques adresses en ville.
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
<div class="fluid-container">
  <div class="row">
    <div class="col-xs-12">
      <div id="map" style="width: 100%; height: 300px;"></div>
    </div>
  </div>

</div>


<% content_for(:after_js) do %>
 <%= javascript_tag do %>
   $(document).on('ready', function() {
     handler = Gmaps.build('Google');
     handler.buildMap({ internal: { id: 'map' } }, function(){
       markers = handler.addMarkers(<%= raw @markers.to_json %>);
       handler.bounds.extendWith(markers);
       handler.fitMapToBounds();
     });
   })
 <% end %>
<% end %>

